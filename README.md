##PowerShell helper functions for Azure HDInsight

This is a collection of helper functions I've created for working with HDInsight. Currently it provides functions for uploading (add,) downloading (get,) listing (find,) and deleting (remove,) operations on files in the HDInsight cluster primary storage account.

The primary storage account for an HDInsight cluster is really just an Azure blob, so these helpers are really just using the Azure PowerShell cmdlets for blob operations. But, they query your HDInsight cluster to figure out the storage to use, so you only have to know the cluster name for these operations.

As I encounter other common tasks that can benefit from helper functions, I'll add them to this project.

##Contributing

If you have things you'd like to see in this collection, add an issue using the issues link. If you have something you'd like to contribute, fork this repository, write the code, test it, then send a pull request.

##Why do this?

Because actions like uploading and downloading files are things you do every day, so it makes sense to encapsulate them in a nice function, rather than writing 5+ lines of code everytime you write a new script to upload something, run a job, and download the results.

##Installing

1.	Download the `hdinsight-tools.psm1`.

2.	From PowerShell, use `import-module hdinsight-tools.psm1` to load the module.

##Using

You must have an active Azure subscription to use this. You must also have an active subscription associated with the Azure PowerShell (Add-AzureAccount or Import-AzurePublishSettingsFile). The HDInsight-Tools will bark at you if you don't have these.

###Working with files

-	**Add-WASB** - Adds a single file from the local system to the WASB path for the HDInsight cluster

-	**Remove-WASB** - Removes a single file from the WASB path for the HDInsight cluster

-	**Get-WASB** - Gets a single file from the WASB path for the HDInsight cluster

-	**Find-WASB** - Lists file(s) from the WASB path for the HDInsight cluster

-	**Get-HDInsightStorage** - Lists the storage account(s) associated with your HDInsight cluster. Mostly useful if you are going to use some other tool like [AzCopy](http://aka.ms/azcopy)

All the *-WASB cmdlets expect a WASB style path, which can be specified through position or the -wasbPath parameter. The following are acceptable path formats:

-	path/to/something.ext

-	/path/to/something.ext

-	wasb:///path/to/something.ext

-	wasb://container@storageaccountname.blob.windows.net/path/to/something.ext

So this should sync up with the paths you'd use inside HDInsight.

###Obsolete cmdlets

These were the previous cmdlets included in this module. They are still there, but flagged as obsolete. They didn't use WASB style paths, which always bugged me. I'll remove them in a future version.

-	**Add-HDInsightFile** - Adds a single file from the local file system (or networked,) to the primary storage container for your HDInsight cluster

-	**Remove-HDInsightFile** - Removes a single file from the primary storage container for your HDInsight cluster

-	**Get-HDInsightFile** - Gets a single file from the primary storage container for your HDInsight cluster

-	**Find-HDInsightFile** - Lists file(s) from the primary storage container for your HDInsight cluster

##Note

This currently only works on one file at a time. Mainly because it depends on using a context generated by New-AzureStorageContext, and this doesn't serialize/deserialize when using workflows, which you have to use with foreach -parallel. If you have a solution to this to allow parallel file operations using a file context, please let me know. Otherwise, use Get-HDInsightStorage to find your storage containers, then use something like AzCopy to perform bulk copy operations.
